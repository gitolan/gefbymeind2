local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- Function to teleport the character to a specified CFrame
local function teleportCharacterToCFrame(cframe)
    local character = game.Players.LocalPlayer.Character
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    humanoidRootPart.CFrame = cframe
end

local function TeleportAndJump(cframe)
    local character = game.Players.LocalPlayer.Character
    if character then
        local root = getRoot(character)
        root.CFrame = cframe -- Teleport ke posisi yang ditentukan
        wait(0.1) -- Tunggu sebentar sebelum melompat
        for i = 1, 3 do
            root.Velocity = Vector3.new(0, 50, 0) -- Atur kecepatan vertikal untuk melompat
            wait(0.5) -- Tunggu sebentar sebelum melompat lagi
        end
        -- Orientasi karakter ke atas
        character:SetPrimaryPartCFrame(cframe)
    end
end

-- Function for button fade effect
local function buttonFadeEffect(button)
    local defaultColor = button.BackgroundColor3
    button.MouseButton1Down:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        wait(0.1)
        button.BackgroundColor3 = defaultColor
    end)
end

-- Function to create ESP for a button
local function createButtonESP(button, cframe)
    local esp = Instance.new("BillboardGui")
    esp.AlwaysOnTop = true
    esp.Size = UDim2.new(1, 0, 1, 0)
    esp.StudsOffset = Vector3.new(0, 3, 0) -- Adjust the offset as needed
    esp.Adornee = button
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Text = button.Text
    nameLabel.Font = Enum.Font.SourceSans
    nameLabel.TextSize = 18
    nameLabel.TextColor3 = Color3.new(1, 1, 1)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Size = UDim2.new(1, 0, 1, 0)
    nameLabel.Parent = esp
    esp.Parent = game.CoreGui
end

-- Function to get current time of day
local function getTimeOfDay()
    local hour = tonumber(os.date("%H"))
    if hour >= 6 and hour < 18 then
        return "Day"
    else
        return "Night"
    end
end

-- Function to format time in seconds to HH:MM:SS
local function formatTime(seconds)
    local hours = math.floor(seconds / 3600)
    local minutes = math.floor((seconds % 3600) / 60)
    local remainingSeconds = seconds % 60
    return string.format("%02d:%02d:%02d", hours, minutes, remainingSeconds)
end

-- ตั้งค่า ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false

-- ตั้งค่า MainFrame
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
MainFrame.Position = UDim2.new(0, 20, 0, 20)
MainFrame.Size = UDim2.new(0, 350, 0, 250)
MainFrame.Active = true
MainFrame.Draggable = true

-- Create minimize/expand button
local minimizeExpandButton = Instance.new("TextButton")
minimizeExpandButton.Text = "_"
minimizeExpandButton.Size = UDim2.new(0, 20, 0, 20)
minimizeExpandButton.Position = UDim2.new(1, -45, 0, 25)
minimizeExpandButton.Parent = MainFrame
minimizeExpandButton.MouseButton1Click:Connect(function()
buttonFadeEffect(minimizeExpandButton)

-- Create teleport buttons with small size
local buttonSize = UDim2.new(0, 100, 0, 20)

-- Create button for Workshop
local workshopButton = Instance.new("TextButton")
workshopButton.Text = "TpWorkshop"
workshopButton.Size = buttonSize
workshopButton.Position = UDim2.new(0, 10, 0, 60)
workshopButton.Parent = MainFrame
workshopButton.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(483.749878, 3.25000095, -19.7498322))
end)
buttonFadeEffect(workshopButton)

createButtonESP(spawn, Vector3.new(-66, 0.600000381, -49, 1, 0, 0, 0, 0, 1, 0, -1, 0))

local towerButton = Instance.new("TextButton")
towerButton.Text = "TpTower"
towerButton.Size = buttonSize
towerButton.Position = UDim2.new(0, 10, 0, 90)
towerButton.Parent = MainFrame
towerButton.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(-117.500183, 52.5, -676.999817))
end)
buttonFadeEffect(towerButton)

local miniHouseButton = Instance.new("TextButton")
miniHouseButton.Text = "TpMini House"
miniHouseButton.Size = buttonSize
miniHouseButton.Position = UDim2.new(0, 10, 0, 120)
miniHouseButton.Parent = MainFrame
miniHouseButton.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(581, 1, -435))
end)
buttonFadeEffect(miniHouseButton)

local safePlaceButton = Instance.new("TextButton")
safePlaceButton.Text = "tpSafe Place"
safePlaceButton.Size = buttonSize
safePlaceButton.Position = UDim2.new(0, 10, 0, 150)
safePlaceButton.Parent = MainFrame
safePlaceButton.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(37.0005646, 5.37508202, 297.246735))
end)
buttonFadeEffect(safePlaceButton)

local secondFloorHouseButton = Instance.new("TextButton")
secondFloorHouseButton.Text = "tp2nd Floor House"
secondFloorHouseButton.Size = buttonSize
secondFloorHouseButton.Position = UDim2.new(0, 180, 0, 60)
secondFloorHouseButton.Parent = MainFrame
secondFloorHouseButton.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(-228.5, 2.50001144, -120.5))
end)
buttonFadeEffect(secondFloorHouseButton)

local shop1Button = Instance.new("TextButton")
shop1Button.Text = "tpShop 1"
shop1Button.Size = buttonSize
shop1Button.Position = UDim2.new(0, 180, 0, 90)
shop1Button.Parent = MainFrame
shop1Button.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(-20.9999962, 5, 12))
end)
buttonFadeEffect(shop1Button)

-- Create button for Hospital 3rd Floor
local hospital3rdFloorButton = Instance.new("TextButton")
hospital3rdFloorButton.Text = "tpHospital 3rd Floor"
hospital3rdFloorButton.Size = buttonSize
hospital3rdFloorButton.Position = UDim2.new(0, 10, 0, 180)
hospital3rdFloorButton.Parent = MainFrame
hospital3rdFloorButton.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(643, 42.4999962, 254, -1, 0, 0, 0, 1, 0, 0, 0, -1))
end)
buttonFadeEffect(hospital3rdFloorButton)

-- Create button for Hospital 1st Floor
local hospital1stFloorButton = Instance.new("TextButton")
hospital1stFloorButton.Text = "tpHospital 1st Floor"
hospital1stFloorButton.Size = buttonSize
hospital1stFloorButton.Position = UDim2.new(0, 180, 0, 180)
hospital1stFloorButton.Parent = MainFrame
hospital1stFloorButton.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(635, 22.4999943, 147.5, -1, 0, 0, 0, 1, 0, 0, 0, -1))
end)
buttonFadeEffect(hospital1stFloorButton)

-- Create button for Water Tank
local waterTankButton = Instance.new("TextButton")
waterTankButton.Text = "TpWater Tank"
waterTankButton.Size = buttonSize
waterTankButton.Position = UDim2.new(0, 180, 0, 210)
waterTankButton.Parent = MainFrame
waterTankButton.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(-363.50177, 55.3741302, -291.122589, 0, -1, 0, 1, 0, 0, 0, 0, 1))
end)
buttonFadeEffect(waterTankButton)

-- Create button for Spawn
local spawnButton = Instance.new("TextButton")
spawnButton.Text = "Teleport to Spawn"
spawnButton.Size = buttonSize
spawnButton.Position = UDim2.new(0, 10, 0, 210)
spawnButton.Parent = MainFrame
spawnButton.MouseButton1Click:Connect(function()
    teleportCharacterToCFrame(CFrame.new(-66, 0.600000381, -49, 1, 0, 0, 0, 0, 1, 0, -1, 0))
end)
buttonFadeEffect(spawnButton)

-- Function to toggle visibility of buttons
local function toggleButtonsVisibility(visible)
    minimizeExpandButton.Visible = visible
    workshopButton.Visible = visible
    towerButton.Visible = visible
    miniHouseButton.Visible = visible
    safePlaceButton.Visible = visible
    secondFloorHouseButton.Visible = visible
    shop1Button.Visible = visible
    hospital1stFloorButton.Visible = visible
    waterTankButton.Visible = visible
    spawnButton.Visible = visible
end

local function ToggleFrame()
    MainFrame.Visible = not MainFrame.Visible
end

local function ToggleButtons()
    if isMinimized then
        ToggleElements(true)
    else
        ToggleElements(false)
    end
end

-- Variable to store uptime in seconds
local uptimeSeconds = 0

local function ToggleFrame()
    MainFrame.Visible = not isMinimized
    if isMinimized then
        MainFrame.BackgroundTransparency = 1 -- Mengatur transparansi menjadi 100% untuk membuatnya tidak terlihat
    else
        MainFrame.BackgroundTransparency = 0.5
    end
end

-- Variable to track the status of minimize button
local isMinimized = false
minimizeExpandButton.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized
    ToggleFrame()
    if isMinimized then
        MainFrame.BackgroundTransparency = 1
        ToggleElements(true) -- o
        minimizeButton.Visible = false -- l
    else
        MainFrame.BackgroundTransparency = 0.5
        ToggleElements(false) -- p
        minimizeButton.Visible = h
    end
end)

-- Create uptime display
local uptimeDisplay = Instance.new("TextLabel")
uptimeDisplay.Text = "Uptime: 00:00:00"
uptimeDisplay.TextColor3 = Color3.new(1, 1, 1)
uptimeDisplay.Size = UDim2.new(0, 100, 0, 20)
uptimeDisplay.Position = UDim2.new(1, -120, 1, -30)
uptimeDisplay.Parent = MainFrame

-- Update uptime every second
RunService.Heartbeat:Connect(function()
    uptimeSeconds = uptimeSeconds + 1
    local formattedTime = formatTime(uptimeSeconds)
    uptimeDisplay.Text = "Uptime: " .. formattedTime
end)
